<?xml version="1.0"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
         xmlns:s="library://ns.adobe.com/flex/spark"
         xmlns:busyindicator="dittner.gsa.view.common.busyIndicator.*"
         xmlns:mx="mx.core.*"
         addedToStage="addedToStageHandler(event)">

    <fx:Script><![CDATA[
        import dittner.gsa.view.common.popup.SimplePopup;
        import dittner.gsa.view.common.view.ViewBase;

        [Embed(source="/bg.png")]
        private var BgClass:Class;
        private static var bg:DisplayObject;

        private function addedToStageHandler(event:Event):void {
            if (bg && bg.parent) {
                bg.parent.removeChild(bg);
            }
            else if (!bg) {
                bg = new BgClass();
            }

            bgCont.addChild(bg);

            SimplePopup.container.percentHeight = 100;
            SimplePopup.container.percentWidth = 100;
            popupLayer.addElement(SimplePopup.container);
        }

        public function addView(view:ViewBase):void {
            viewCont.addElement(view);
        }

        public function removeView():void {
            viewCont.removeAllElements();
        }

        public function lock():void {
            setCurrentState("lock");
        }

        public function unlock():void {
            setCurrentState("normal");
        }
        ]]></fx:Script>

    <s:states>
        <s:State name="disabled"/>
        <s:State name="normal"/>
        <s:State name="lock"/>
    </s:states>

    <mx:UIComponent id="bgCont"/>

    <s:Group id="viewCont"
             width="100%"
             height="100%"/>

    <s:Group id="popupLayer" width="100%" height="100%"/>

    <s:Group id="busyIndicatorLayer" width="100%" height="100%">
        <s:Rect width="100%" height="100%"
                visible="false" visible.lock="true">
            <s:fill>
                <s:SolidColor color="#aaAAaa" alpha=".5"/>
            </s:fill>
        </s:Rect>

        <busyindicator:ClockBusyIndicator verticalCenter="0" horizontalCenter="0"
                                          visible="false" visible.lock="true"/>
    </s:Group>

</s:Group>
